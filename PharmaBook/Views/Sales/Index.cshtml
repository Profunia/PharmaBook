
@{
    ViewData["Title"] = "Index";
}
<h2>Create Invoice</h2>
<div ng-controller="SalesController">
    <div class="blankpage-main" ng-show="!isCreatedInvoice">
        @*<div class="row">
                <div class="col-xs-4">
                    <a href="" class="btn btn-primary" ng-click="bcktoinbx('create')">Back to Inbox</a>
                </div>
            </div>*@
        <div class="row mt">
            <div class="col-xs-6">
                <div class="form-group">
                    <label>Patient Name <span style="color:red;"> </span></label>
                    <input required class="form-control" placeholder="Patient Name" ng-model="master.PatientName">
                    <span asp-for="name" style="color:red;"></span>
                </div>
                <div class="form-group">
                    <label>Address <span style="color:red;"> </span></label>
                    <input class="form-control" required placeholder="Address" ng-model="master.PatientAdres">
                    <span asp-for="batchNo" style="color:red;"></span>
                </div>
            </div>
            <div class="col-xs-6">
                <div class="form-group">
                    <label>Dr. Name</label>
                    <input class="form-control" placeholder="Dr. Name" ng-model="master.DrName">
                </div>
                <div class="form-group">
                    <label>Regd. No</label>
                    <input class="form-control" placeholder="Regd. No" ng-model="master.RegNo">
                </div>
            </div>
        </div>
    </div><br />
    <div class="blankpage-main" ng-show="!isCreatedInvoice">
        <div class="row">
            <div class="col-xs-6">
                <div class="form-group">
                    <label>Medicine <span style="color:red;"> * </span></label>
                    <select class="form-control" required placeholder="Medicine" ng-model="PrdId" ng-options="s.id as s.name for s in ProductList" ng-change="medicineselect()"></select>
                    <span asp-for="batchNo" style="color:red;"></span>
                </div>
            </div>
            <div class="col-xs-6">
                <div class="form-group">
                    <label>Description <span style="color:red;"> * </span></label>
                    <input class="form-control" required placeholder="Desciption" ng-model="child.Description">
                    <span asp-for="batchNo" style="color:red;"></span>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-xs-2">
                <div class="form-group">
                    <label>Qty <span style="color:red;"> * </span></label>
                    <input required class="form-control" placeholder="Qty" ng-model="Qty">
                    <span asp-for="name" style="color:red;"></span>
                </div>
            </div>
            <div class="col-xs-3">
                <div class="form-group">
                    <label>MRP</label> <span style="color:red;"> *</span>
                    <input required class="form-control" placeholder="MRP" ng-model="child.Amount">
                </div>
            </div>
            <div class="col-xs-4">
                <div class="form-group">
                    <label>Exp. Date </label>
                    <input class="form-control" placeholder="Exp Date" ng-model="child.ExpDt| date :  'dd-MM-y' ">
                    <span asp-for="batchNo" style="color:red;"></span>
                </div>
            </div>
            <div class="col-xs-3">
                <div class="form-group">
                    <label>Batch No.# </label>
                    <input class="form-control" placeholder="Batch No" ng-model="child.BatchNo">
                    <span asp-for="batchNo" style="color:red;"></span>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-xs-3">
                <div class="form-group">
                    <br />
                    <button type="submit" class="btn btn-primary" ng-click="AddChildInvc()">Add to Cart</button>
                </div>
            </div>
        </div>

    </div><br />
    <div class="blankpage-main" ng-if="!isCreatedInvoice">
        <div class="row mt">
            <div class="col-md-12">
                <div class="content-panel">                 
                    <div style="overflow: auto;height: 350px;">
                        <table class="table table-striped table-advance table-hover">
                            <thead>
                                <tr>
                                    <th>#</th>
                                    <th>Qty</th>
                                    <th>Description</th>
                                    <th>Batch No.#</th>
                                    <th>Exp Date</th>
                                    <th>MRP</th>
                                    <th>Rs</th>
                                    <th> Action</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr ng-repeat="item in cartlists|filter: searchbox">
                                    <td>{{$index+1}}</td>
                                    <td>{{item.Qty}}</td>
                                    <td>{{item.Description}}</td>
                                    <td>{{item.BatchNo}}</td>
                                    <td>{{item.ExpDt | date :  "dd-MM-y" }}</td>
                                    <td>{{unitprice|number:2}}</td>
                                    <td>{{item.Amount|number:2}}</td>
                                    <td>
                                        <button class="btn btn-danger btn-xs" ng-click="DelCrtIitem($index)"><i class="fa fa-trash-o"></i> Delete</button>
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="5"></td>
                                    <th>Total</th>
                                    <th>Rs. {{totalprice | number:2}}</th>
                                </tr>
                            </tbody>
                        </table>
                        <div class="form-group">
                            <button type="submit" class="btn btn-primary" ng-click="SaveInvc()">Submit</button>
                        </div>
                    </div>
                </div><!-- /content-panel -->
            </div><!-- /col-md-12 -->
        </div>

    </div>
    <div class="blankpage-main" ng-show="isCreatedInvoice">
        <div class="row alert alert-success">
            <span>
                {{successMessage}}
            </span>
        </div>
        <br />
        <div class="row">
            <div class="col-xs-6">
                <button class="btn btn-primary" style="float:left" ng-click="PrintInvoice()">Print Invoice</button> 
                <!-- TODO Add invoice print link-->
            </div>
            <div class="col-xs-6">
                <button class="btn btn-primary"
                  style="float:right" ng-click="switchToInvoicePage()"> << Create New Invoice</button>
            </div>
        </div>
    </div>
</div>
